<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="admiralci">
<title>Common Structure • admiralci</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Common Structure">
<meta property="og:description" content="admiralci">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admiralci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-basics">Basics</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-basics">
    <a class="dropdown-item" href="../articles/common_structure.html">Common structure of the workflows</a>
    <a class="dropdown-item" href="../articles/cheatsheet.html">Cheatsheet</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-workflows-details">Workflows Details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-workflows-details">
    <a class="dropdown-item" href="../articles/r-cmd-checks.html">R CMD CHECKS</a>
    <a class="dropdown-item" href="../articles/cran-status.html">Cran Status</a>
    <a class="dropdown-item" href="../articles/code-coverage.html">Code Coverage</a>
    <a class="dropdown-item" href="../articles/check-templates.html">Check Templates</a>
    <a class="dropdown-item" href="../articles/links.html">Links (Check broken links)</a>
    <a class="dropdown-item" href="../articles/lintr.html">Lintr (Code lints)</a>
    <a class="dropdown-item" href="../articles/style.html">Style (Code style)</a>
    <a class="dropdown-item" href="../articles/spellchecks.html">Spellchecks</a>
    <a class="dropdown-item" href="../articles/man-pages.html">Man pages (Code Doc Rendering)</a>
    <a class="dropdown-item" href="../Readme.Rmd">Readme Render (Readme.Rmd -&gt; Readme.md)</a>
    <a class="dropdown-item" href="../articles/pkgdown.html">Pkgdown (build doc from Vignettes)</a>
    <a class="dropdown-item" href="../articles/tweak-page-hooks.html">Tweak Pages (fix pkgdown broken links)</a>
    <a class="dropdown-item" href="../articles/pkgdown.html">Pkgdown (build doc from Vignettes)</a>
    <a class="dropdown-item" href="../articles/validation.html">Validation (build PDF validation report)</a>
    <a class="dropdown-item" href="../articles/push-docker.html">Push Docker Images</a>
    <a class="dropdown-item" href="../articles/docker_and_codespaces.html">Codespaces</a>
    <a class="dropdown-item" href="../articles/propagate.html">Propagate (share codespaces conf)</a>
    <a class="dropdown-item" href="../articles/check-r-tags.html">Check R latest version</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://app.slack.com/client/T028PB489D3/C02M8KN8269" aria-label="Slack">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaverse/admiralci/issues/new/choose" aria-label="New Issue">
    <span class="fa fa-bug"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaverse/admiralci/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Common Structure</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiralci/blob/HEAD/vignettes/common_structure.Rmd" class="external-link"><code>vignettes/common_structure.Rmd</code></a></small>
      <div class="d-none name"><code>common_structure.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="common-structure-of-the-workflows">Common structure of the workflows<a class="anchor" aria-label="anchor" href="#common-structure-of-the-workflows"></a>
</h2>
<div class="section level3">
<h3 id="r-version-input">R-version input<a class="anchor" aria-label="anchor" href="#r-version-input"></a>
</h3>
<p>For most of the workflows, we need to select a specific R version.
That’s why most of the actions have a <code>r-version</code> input:</p>
<pre><code><span><span class="va">inputs</span><span class="op">:</span></span>
<span>    <span class="va">r</span><span class="op">-</span><span class="va">version</span><span class="op">:</span></span>
<span>      <span class="va">description</span><span class="op">:</span> <span class="st">'The version of R to use'</span></span>
<span>      <span class="va">default</span><span class="op">:</span> <span class="st">'release'</span></span>
<span>      <span class="va">required</span><span class="op">:</span> <span class="va">false</span></span>
<span>      <span class="va">type</span><span class="op">:</span> <span class="va">choice</span></span>
<span>      <span class="va">options</span><span class="op">:</span></span>
<span>        <span class="op">-</span> <span class="va">devel</span></span>
<span>        <span class="op">-</span> <span class="va">oldrel</span></span></code></pre>
<p>By default, we have <code>r-version=release</code>, and users can
also use <code>devel</code> and <code>latest</code> versions.</p>
<ul>
<li>
<code>release</code> means we are using latest stable version of
<code>R</code>.</li>
<li>
<code>oldrel</code> means we are using previous release of R (for
example if current release is <code>4.4</code>, oldrel will be
<code>4.3</code>).</li>
<li>
<code>devel</code> refers to the development version of R, which
contains the latest changes and features that are still under
development. This version is typically used by developers who want to
test new features. The “devel” version may be less stable.</li>
</ul>
</div>
<div class="section level3">
<h3 id="use-of-admiralci-docker-images">Use of <code>admiralci</code> docker images<a class="anchor" aria-label="anchor" href="#use-of-admiralci-docker-images"></a>
</h3>
<p>Once the <code>r-version</code> is picked, the worfklows will run
inside a docker container instance. Indeed, <code>admiralci</code>
contains an action <code>push-docker-image</code>, to be able to build
<code>rocker:rstudio</code> images for each available version of
<code>R</code> :</p>
<ul>
<li><code>admiralci-oldrelease</code></li>
<li><code>admiralci-release</code></li>
<li><code>admiralci-devel</code></li>
</ul>
<p>These images are stored in admiralci ghcr (Github Container Registry
- Place to store docker images), and are then reused to execute the
workflows in docker container instances like this :</p>
<pre><code><span><span class="va">container</span><span class="op">:</span></span>
<span>    <span class="va">image</span><span class="op">:</span> <span class="st">"ghcr.io/pharmaverse/admiralci-${{ inputs.r-version }}:latest"</span></span></code></pre>
<p>(For more details on docker images creation process, please read <a href="push-docker.html">Push Docker Images</a>) workflow
documentation).</p>
</div>
<div class="section level3">
<h3 id="checkout-repository">Checkout repository<a class="anchor" aria-label="anchor" href="#checkout-repository"></a>
</h3>
<p>This action is used to checkout on the right repository. This is a
step commonly used in github actions to be able to access a repository
tree.</p>
<pre><code>- name: Checkout repository
  uses: actions/checkout@v3</code></pre>
</div>
<div class="section level3">
<h3 id="staged-dependencies">Staged dependencies<a class="anchor" aria-label="anchor" href="#staged-dependencies"></a>
</h3>
<p>The staged dependencies action allow to install every necessary
upstream dependencies for <code>admiral</code> package, such as :</p>
<ul>
<li>
<code>pharmaversesdtm</code> (SDTM test data)</li>
<li>
<code>admiraldev</code> (utilities functions for the Admiral package
family)</li>
</ul>
<p>(note that these dependencies are refered inside
<code>staged_dependencies.yml</code> file)</p>
<p>For more details about staged.dependencies, please visit these links
:</p>
<ul>
<li><a href="https://github.com/openpharma/staged.dependencies" class="external-link">Staged
Dependencies Package</a></li>
<li>
<a href="https://github.com/insightsengineering/staged-dependencies-action" class="external-link">Staged
Dependencies Action</a> (Github action to use Staged Dependencies
package through github workflows)</li>
</ul>
<pre><code>- name: Run Staged dependencies
    uses: insightsengineering/staged-dependencies-action@v1
    with:
        run-system-dependencies: false
        renv-restore: false
    env:
        GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}</code></pre>
<p>Note : the user can specify some parameters depending on the use case
: - run-system-dependencies : install or not sys dependencies -
renv-restore : restore or not renv.lock dependencies (and many other
options you can find on Staged Dependencies Action documentation).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dinakar Kulkarni, Daphne Grasselly, Adam Forys, Franciszek Walkowiak.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
